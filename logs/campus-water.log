2025-05-26 13:57:15.938 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 54176 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 13:57:15.947 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 13:57:17.248 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 13:57:17.258 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 13:57:17.261 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 13:57:17.261 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 13:57:17.398 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 13:57:17.400 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1385 ms
2025-05-26 13:57:17.676 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 13:57:18.102 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 13:57:18.302 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 13:57:18.694 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 13:57:18.706 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 13:57:19.106 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 13:57:19.165 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 13:57:19.196 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.964 seconds (JVM running for 5.185)
2025-05-26 13:57:45.495 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {"id":12345,"TDS":74,"locate":"libray","status":"0"}
2025-05-26 13:57:45.637 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 13:57:45.844 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据保存成功: WaterDispenser(id=12345, locate=libray, tds=74, status=0, tip=null, time=null)
2025-05-26 13:58:45.129 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 13:58:45.129 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 13:58:45.129 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 13:58:50.352 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 13:58:50.353 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 13:58:50.354 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 13:58:52.976 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 13:58:52.976 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 13:58:52.976 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 13:58:56.655 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 13:58:56.655 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 13:58:56.655 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 13:59:00.061 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 13:59:00.062 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 13:59:00.062 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 13:59:03.952 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 13:59:03.953 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 13:59:03.953 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 13:59:18.780 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 13:59:18.780 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 13:59:18.780 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 13:59:21.383 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"warning"}
2025-05-26 13:59:21.383 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 13:59:21.383 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: warning
2025-05-26 13:59:30.678 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 13:59:30.679 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 13:59:30.679 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 13:59:33.521 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 13:59:33.522 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 13:59:33.522 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 13:59:37.532 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 13:59:37.533 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 13:59:37.533 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 13:59:40.886 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 13:59:40.887 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 13:59:40.887 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 14:00:05.953 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"13:40:41","drink":350}
2025-05-26 14:00:05.959 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: syntax error, expect [, actual {, pos 0, fieldName null
com.alibaba.fastjson.JSONException: syntax error, expect [, actual {, pos 0, fieldName null
	at com.alibaba.fastjson.parser.DefaultJSONParser.parseArray(DefaultJSONParser.java:1182)
	at com.alibaba.fastjson.parser.DefaultJSONParser.parseArray(DefaultJSONParser.java:1169)
	at com.alibaba.fastjson.JSON.parseArray(JSON.java:612)
	at com.alibaba.fastjson.JSON.parseArray(JSON.java:592)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:00:11.915 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubIDdata] 的消息: {"id":12345}
2025-05-26 14:00:11.915 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机 [12345] 的饮水记录列表查询请求...
2025-05-26 14:00:11.949 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subRIDdata]: []
2025-05-26 14:00:11.953 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 14:00:11.954 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 的饮水记录列表查询结果: 0条记录
2025-05-26 14:00:11.956 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: []
2025-05-26 14:00:24.536 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 14:00:24.536 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 14:00:24.536 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 14:00:30.669 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 14:00:30.669 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 14:00:30.670 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 14:00:33.648 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 14:00:33.649 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 14:00:33.649 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 14:00:36.253 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 14:00:36.254 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 14:00:36.254 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 14:00:38.849 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 14:00:38.849 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 14:00:38.849 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 14:00:42.677 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 14:00:42.677 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 14:00:42.677 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 14:00:46.867 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 14:00:46.868 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 14:00:46.868 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 14:01:26.947 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"13:42:02","drink":0}
2025-05-26 14:01:26.947 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: syntax error, expect [, actual {, pos 0, fieldName null
com.alibaba.fastjson.JSONException: syntax error, expect [, actual {, pos 0, fieldName null
	at com.alibaba.fastjson.parser.DefaultJSONParser.parseArray(DefaultJSONParser.java:1182)
	at com.alibaba.fastjson.parser.DefaultJSONParser.parseArray(DefaultJSONParser.java:1169)
	at com.alibaba.fastjson.JSON.parseArray(JSON.java:612)
	at com.alibaba.fastjson.JSON.parseArray(JSON.java:592)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:01:48.918 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 14:01:48.919 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 14:01:48.919 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 14:01:52.589 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 14:01:52.591 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 14:01:52.591 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 14:01:57.753 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"13:42:30","drink":0}
2025-05-26 14:01:57.754 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: syntax error, expect [, actual {, pos 0, fieldName null
com.alibaba.fastjson.JSONException: syntax error, expect [, actual {, pos 0, fieldName null
	at com.alibaba.fastjson.parser.DefaultJSONParser.parseArray(DefaultJSONParser.java:1182)
	at com.alibaba.fastjson.parser.DefaultJSONParser.parseArray(DefaultJSONParser.java:1169)
	at com.alibaba.fastjson.JSON.parseArray(JSON.java:612)
	at com.alibaba.fastjson.JSON.parseArray(JSON.java:592)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:02:15.940 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"13:42:51","drink":400}
2025-05-26 14:02:15.942 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: syntax error, expect [, actual {, pos 0, fieldName null
com.alibaba.fastjson.JSONException: syntax error, expect [, actual {, pos 0, fieldName null
	at com.alibaba.fastjson.parser.DefaultJSONParser.parseArray(DefaultJSONParser.java:1182)
	at com.alibaba.fastjson.parser.DefaultJSONParser.parseArray(DefaultJSONParser.java:1169)
	at com.alibaba.fastjson.JSON.parseArray(JSON.java:612)
	at com.alibaba.fastjson.JSON.parseArray(JSON.java:592)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:02:16.039 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"李想"}
2025-05-26 14:02:16.039 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录列表查询请求...
2025-05-26 14:02:16.048 [MQTT Call: campus-water-server] WARN  com.campus.water.service.MqttService - 未找到学生 [李想] 的饮水卡信息
2025-05-26 14:02:16.051 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: {"error":"饮水卡不存在"}
2025-05-26 14:02:16.054 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 14:02:20.230 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubIDdata] 的消息: {"id":12345}
2025-05-26 14:02:20.231 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机 [12345] 的饮水记录列表查询请求...
2025-05-26 14:02:20.237 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subRIDdata]: []
2025-05-26 14:02:20.242 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 14:02:20.243 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 的饮水记录列表查询结果: 0条记录
2025-05-26 14:02:20.244 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: []
2025-05-26 14:03:47.158 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubIDdata] 的消息: {"id":12345}
2025-05-26 14:03:47.159 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机 [12345] 的饮水记录列表查询请求...
2025-05-26 14:03:47.178 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subRIDdata]: []
2025-05-26 14:03:47.221 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 14:03:47.222 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 的饮水记录列表查询结果: 0条记录
2025-05-26 14:03:47.226 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: []
2025-05-26 14:04:51.763 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 14:04:51.763 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 14:04:51.764 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 14:04:56.936 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"14:04:03","drink":0}
2025-05-26 14:04:56.939 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: syntax error, expect [, actual {, pos 0, fieldName null
com.alibaba.fastjson.JSONException: syntax error, expect [, actual {, pos 0, fieldName null
	at com.alibaba.fastjson.parser.DefaultJSONParser.parseArray(DefaultJSONParser.java:1182)
	at com.alibaba.fastjson.parser.DefaultJSONParser.parseArray(DefaultJSONParser.java:1169)
	at com.alibaba.fastjson.JSON.parseArray(JSON.java:612)
	at com.alibaba.fastjson.JSON.parseArray(JSON.java:592)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:05:00.994 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 14:05:00.995 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 14:05:00.995 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 14:05:05.058 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 14:05:05.059 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 14:05:05.059 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 14:05:15.410 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subTip] 的消息: {"id":12345,"tip":"error"}
2025-05-26 14:05:15.411 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机故障信息...
2025-05-26 14:05:15.411 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 无效的故障信息格式: error
2025-05-26 14:05:20.560 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"14:04:27","drink":0}
2025-05-26 14:05:20.572 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: syntax error, expect [, actual {, pos 0, fieldName null
com.alibaba.fastjson.JSONException: syntax error, expect [, actual {, pos 0, fieldName null
	at com.alibaba.fastjson.parser.DefaultJSONParser.parseArray(DefaultJSONParser.java:1182)
	at com.alibaba.fastjson.parser.DefaultJSONParser.parseArray(DefaultJSONParser.java:1169)
	at com.alibaba.fastjson.JSON.parseArray(JSON.java:612)
	at com.alibaba.fastjson.JSON.parseArray(JSON.java:592)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:07:01.919 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 14:07:01.985 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 14:07:12.341 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 8836 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 14:07:12.343 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 14:07:14.413 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 14:07:14.423 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 14:07:14.425 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 14:07:14.425 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 14:07:14.544 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 14:07:14.545 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2135 ms
2025-05-26 14:07:14.820 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 14:07:15.041 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 14:07:15.183 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 14:07:15.552 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 14:07:15.571 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 14:07:16.108 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 14:07:16.158 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 14:07:16.180 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 4.534 seconds (JVM running for 5.63)
2025-05-26 14:07:44.926 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"14:06:53","drink":150}
2025-05-26 14:07:45.028 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 14:07:45.040 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":"93 27 68 EC","time":"14:06:53","drink":150}
2025-05-26 14:07:45.042 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水记录数据失败: For input string: "93 27 68 EC"
java.lang.NumberFormatException: For input string: "93 27 68 EC"
	at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:67)
	at java.base/java.lang.Integer.parseInt(Integer.java:662)
	at java.base/java.lang.Integer.parseInt(Integer.java:778)
	at com.alibaba.fastjson.util.TypeUtils.castToInt(TypeUtils.java:995)
	at com.alibaba.fastjson.JSONObject.getInteger(JSONObject.java:252)
	at com.campus.water.service.MqttService.handleRidData(MqttService.java:195)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:07:48.199 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubIDdata] 的消息: {"id":12345}
2025-05-26 14:07:48.200 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机 [12345] 的饮水记录列表查询请求...
2025-05-26 14:07:48.335 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subRIDdata]: []
2025-05-26 14:07:48.401 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 14:07:48.401 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 的饮水记录列表查询结果: 0条记录
2025-05-26 14:07:48.402 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: []
2025-05-26 14:07:48.404 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: can not cast to JSONObject.
com.alibaba.fastjson.JSONException: can not cast to JSONObject.
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:260)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:154)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class com.alibaba.fastjson.JSONArray cannot be cast to class com.alibaba.fastjson.JSONObject (com.alibaba.fastjson.JSONArray and com.alibaba.fastjson.JSONObject are in unnamed module of loader 'app')
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:258)
	... 5 common frames omitted
2025-05-26 14:08:48.149 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {"id":12345,"TDS":132,"locate":"libray","status":"0"}
2025-05-26 14:08:48.150 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 14:08:48.158 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 已存在，更新数据
2025-05-26 14:08:48.223 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据更新成功: WaterDispenser(id=12345, locate=libray, tds=132, status=0, tip=null, time=null)
2025-05-26 14:08:49.909 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubIDdata] 的消息: {"id":12345}
2025-05-26 14:08:49.910 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机 [12345] 的饮水记录列表查询请求...
2025-05-26 14:08:49.935 [MQTT Call: campus-water-server] WARN  com.campus.water.service.MqttService - 饮水机 [12345] 不存在
2025-05-26 14:08:49.936 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subRIDdata]: {"error":"饮水机不存在"}
2025-05-26 14:08:49.946 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 14:08:49.953 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"error":"饮水机不存在"}
2025-05-26 14:08:49.954 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 14:08:49.954 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"error":"饮水机不存在"}
2025-05-26 14:08:49.954 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - dispenserId: null, drink: null, time: null
2025-05-26 14:08:49.963 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 饮水机 [null] 不存在，无法添加饮水记录
2025-05-26 14:09:22.058 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 14:09:22.075 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 14:09:28.857 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 54376 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 14:09:28.863 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 14:09:30.495 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 14:09:30.507 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 14:09:30.508 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 14:09:30.509 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 14:09:30.628 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 14:09:30.628 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1705 ms
2025-05-26 14:09:30.792 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 14:09:31.006 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 14:09:31.165 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 14:09:31.541 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 14:09:31.607 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 14:09:32.023 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 14:09:32.049 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 14:09:32.060 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.766 seconds (JVM running for 4.753)
2025-05-26 14:09:36.623 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"14:09:34","drink":0}
2025-05-26 14:09:36.697 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 14:09:36.708 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":"93 27 68 EC","time":"14:09:34","drink":0}
2025-05-26 14:09:36.708 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - id: 93 27 68 EC, drink: 0, time: 14:09:34
2025-05-26 14:09:36.710 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水记录数据失败: For input string: "93 27 68 EC"
java.lang.NumberFormatException: For input string: "93 27 68 EC"
	at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:67)
	at java.base/java.lang.Integer.parseInt(Integer.java:662)
	at java.base/java.lang.Integer.parseInt(Integer.java:778)
	at com.campus.water.service.MqttService.handleRidData(MqttService.java:202)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:09:43.598 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"14:09:41","drink":0}
2025-05-26 14:09:43.599 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 14:09:43.599 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":"93 27 68 EC","time":"14:09:41","drink":0}
2025-05-26 14:09:43.599 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - id: 93 27 68 EC, drink: 0, time: 14:09:41
2025-05-26 14:09:43.599 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水记录数据失败: For input string: "93 27 68 EC"
java.lang.NumberFormatException: For input string: "93 27 68 EC"
	at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:67)
	at java.base/java.lang.Integer.parseInt(Integer.java:662)
	at java.base/java.lang.Integer.parseInt(Integer.java:778)
	at com.campus.water.service.MqttService.handleRidData(MqttService.java:202)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:09:58.329 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"14:09:53","drink":50}
2025-05-26 14:09:58.330 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 14:09:58.330 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":"93 27 68 EC","time":"14:09:53","drink":50}
2025-05-26 14:09:58.330 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - id: 93 27 68 EC, drink: 50, time: 14:09:53
2025-05-26 14:09:58.330 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水记录数据失败: For input string: "93 27 68 EC"
java.lang.NumberFormatException: For input string: "93 27 68 EC"
	at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:67)
	at java.base/java.lang.Integer.parseInt(Integer.java:662)
	at java.base/java.lang.Integer.parseInt(Integer.java:778)
	at com.campus.water.service.MqttService.handleRidData(MqttService.java:202)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:10:07.542 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"14:10:03","drink":50}
2025-05-26 14:10:07.543 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 14:10:07.544 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":"93 27 68 EC","time":"14:10:03","drink":50}
2025-05-26 14:10:07.544 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - id: 93 27 68 EC, drink: 50, time: 14:10:03
2025-05-26 14:10:07.546 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水记录数据失败: For input string: "93 27 68 EC"
java.lang.NumberFormatException: For input string: "93 27 68 EC"
	at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:67)
	at java.base/java.lang.Integer.parseInt(Integer.java:662)
	at java.base/java.lang.Integer.parseInt(Integer.java:778)
	at com.campus.water.service.MqttService.handleRidData(MqttService.java:202)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:10:22.597 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"14:10:20","drink":0}
2025-05-26 14:10:22.598 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 14:10:22.599 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":"93 27 68 EC","time":"14:10:20","drink":0}
2025-05-26 14:10:22.599 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - id: 93 27 68 EC, drink: 0, time: 14:10:20
2025-05-26 14:10:22.599 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水记录数据失败: For input string: "93 27 68 EC"
java.lang.NumberFormatException: For input string: "93 27 68 EC"
	at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:67)
	at java.base/java.lang.Integer.parseInt(Integer.java:662)
	at java.base/java.lang.Integer.parseInt(Integer.java:778)
	at com.campus.water.service.MqttService.handleRidData(MqttService.java:202)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:12:02.188 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubIDdata] 的消息: {"id":12345}
2025-05-26 14:12:02.189 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机 [12345] 的饮水记录列表查询请求...
2025-05-26 14:12:02.284 [MQTT Call: campus-water-server] WARN  com.campus.water.service.MqttService - 饮水机 [12345] 不存在
2025-05-26 14:12:02.285 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subRIDdata]: {"error":"饮水机不存在"}
2025-05-26 14:12:02.288 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 14:12:02.290 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"error":"饮水机不存在"}
2025-05-26 14:12:02.290 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 14:12:02.290 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"error":"饮水机不存在"}
2025-05-26 14:12:02.291 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - id: null, drink: null, time: null
2025-05-26 14:12:02.291 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水记录数据失败: Cannot parse null string
java.lang.NumberFormatException: Cannot parse null string
	at java.base/java.lang.Integer.parseInt(Integer.java:624)
	at java.base/java.lang.Integer.parseInt(Integer.java:778)
	at com.campus.water.service.MqttService.handleRidData(MqttService.java:202)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:13:41.607 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {"id":12345,"TDS":132,"locate":"libray","status":"0"}
2025-05-26 14:13:41.608 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 14:13:41.647 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据保存成功: WaterDispenser(id=12345, locate=libray, tds=132, status=0, tip=null, time=null)
2025-05-26 14:13:54.078 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"14:13:51","drink":0}
2025-05-26 14:13:54.079 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 14:13:54.080 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":"93 27 68 EC","time":"14:13:51","drink":0}
2025-05-26 14:13:54.085 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - id: 93 27 68 EC, drink: 0, time: 14:13:51
2025-05-26 14:13:54.092 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水记录数据失败: For input string: "93 27 68 EC"
java.lang.NumberFormatException: For input string: "93 27 68 EC"
	at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:67)
	at java.base/java.lang.Integer.parseInt(Integer.java:662)
	at java.base/java.lang.Integer.parseInt(Integer.java:778)
	at com.campus.water.service.MqttService.handleRidData(MqttService.java:202)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:14:14.073 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"14:14:11","drink":300}
2025-05-26 14:14:14.074 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 14:14:14.075 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":"93 27 68 EC","time":"14:14:11","drink":300}
2025-05-26 14:14:14.076 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - id: 93 27 68 EC, drink: 300, time: 14:14:11
2025-05-26 14:14:14.079 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水记录数据失败: For input string: "93 27 68 EC"
java.lang.NumberFormatException: For input string: "93 27 68 EC"
	at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:67)
	at java.base/java.lang.Integer.parseInt(Integer.java:662)
	at java.base/java.lang.Integer.parseInt(Integer.java:778)
	at com.campus.water.service.MqttService.handleRidData(MqttService.java:202)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:14:59.164 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 14:14:59.215 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 14:15:07.147 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 47300 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 14:15:07.149 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 14:15:08.649 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 14:15:08.658 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 14:15:08.659 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 14:15:08.659 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 14:15:08.750 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 14:15:08.750 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1562 ms
2025-05-26 14:15:08.982 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 14:15:09.220 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 14:15:09.351 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 14:15:09.729 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 14:15:09.743 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 14:15:10.274 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 14:15:10.299 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 14:15:10.314 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.827 seconds (JVM running for 4.909)
2025-05-26 14:15:23.071 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"14:15:20","drink":200}
2025-05-26 14:15:23.161 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 14:15:23.177 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":"93 27 68 EC","time":"14:15:20","drink":200}
2025-05-26 14:15:23.179 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水记录数据失败: For input string: "93 27 68 EC"
java.lang.NumberFormatException: For input string: "93 27 68 EC"
	at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:67)
	at java.base/java.lang.Integer.parseInt(Integer.java:662)
	at java.base/java.lang.Integer.parseInt(Integer.java:778)
	at com.alibaba.fastjson.util.TypeUtils.castToInt(TypeUtils.java:995)
	at com.alibaba.fastjson.JSONObject.getInteger(JSONObject.java:252)
	at com.campus.water.service.MqttService.handleRidData(MqttService.java:195)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:16:24.066 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"14:16:21","drink":0}
2025-05-26 14:16:24.067 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 14:16:24.068 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":"93 27 68 EC","time":"14:16:21","drink":0}
2025-05-26 14:16:24.075 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水记录数据失败: For input string: "93 27 68 EC"
java.lang.NumberFormatException: For input string: "93 27 68 EC"
	at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:67)
	at java.base/java.lang.Integer.parseInt(Integer.java:662)
	at java.base/java.lang.Integer.parseInt(Integer.java:778)
	at com.alibaba.fastjson.util.TypeUtils.castToInt(TypeUtils.java:995)
	at com.alibaba.fastjson.JSONObject.getInteger(JSONObject.java:252)
	at com.campus.water.service.MqttService.handleRidData(MqttService.java:195)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:17:04.470 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 14:17:04.501 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 14:17:11.725 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 51408 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 14:17:11.729 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 14:17:13.102 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 14:17:13.115 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 14:17:13.117 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 14:17:13.118 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 14:17:13.231 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 14:17:13.231 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1446 ms
2025-05-26 14:17:13.401 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 14:17:13.545 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 14:17:13.770 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 14:17:14.150 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 14:17:14.181 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 14:17:14.746 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 14:17:14.789 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 14:17:14.805 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.741 seconds (JVM running for 4.379)
2025-05-26 14:18:02.360 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {"id":12345,"TDS":132,"locate":"libray","status":"0"}
2025-05-26 14:18:02.475 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 14:18:02.589 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 已存在，更新数据
2025-05-26 14:18:02.603 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据更新成功: WaterDispenser(id=12345, locate=libray, tds=132, status=0, tip=null, time=null)
2025-05-26 14:20:25.356 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 14:20:25.384 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 14:20:33.178 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 9640 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 14:20:33.181 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 14:20:34.641 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 14:20:34.652 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 14:20:34.653 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 14:20:34.653 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 14:20:34.764 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 14:20:34.764 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1514 ms
2025-05-26 14:20:35.034 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 14:20:35.293 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 14:20:35.468 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 14:20:35.836 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 14:20:35.842 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 14:20:36.340 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 14:20:36.393 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 14:20:36.414 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.841 seconds (JVM running for 4.766)
2025-05-26 14:21:04.997 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {"id":12345,"TDS":132,"locate":"libray","status":"0"}
2025-05-26 14:21:05.182 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 14:21:05.251 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 已存在，更新数据
2025-05-26 14:21:05.260 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据更新成功: WaterDispenser(id=12345, locate=libray, tds=132, status=0, tip=null, time=null)
2025-05-26 14:22:23.972 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 14:22:23.991 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 14:22:31.058 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 56624 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 14:22:31.060 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 14:22:32.659 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 14:22:32.673 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 14:22:32.675 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 14:22:32.676 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 14:22:32.821 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 14:22:32.823 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1715 ms
2025-05-26 14:22:33.005 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 14:22:33.366 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 14:22:33.661 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 14:22:34.055 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 14:22:34.075 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 14:22:34.508 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 14:22:34.537 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 14:22:34.547 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 4.129 seconds (JVM running for 5.087)
2025-05-26 14:23:51.633 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 14:23:51.640 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 14:23:56.135 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 23556 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 14:23:56.137 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 14:23:57.575 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 14:23:57.590 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 14:23:57.593 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 14:23:57.593 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 14:23:57.743 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 14:23:57.744 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1568 ms
2025-05-26 14:23:57.912 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 14:23:58.140 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 14:23:58.379 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 14:23:58.800 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 14:23:58.949 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 14:23:59.359 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 14:23:59.389 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 14:23:59.400 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.72 seconds (JVM running for 4.417)
2025-05-26 14:24:07.459 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"14:24:05","drink":0}
2025-05-26 14:24:07.554 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 14:24:07.574 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":"93 27 68 EC","time":"14:24:05","drink":0}
2025-05-26 14:24:07.574 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - cardId: 93 27 68 EC, drink: 0, time: 14:24:05
2025-05-26 14:24:07.642 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 准备保存饮水记录: DrinkRecord(dispenserId=1, drink=0, time=14:24:05)
2025-05-26 14:24:07.842 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水记录数据失败: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`))
### The error may exist in com/campus/water/mapper/DrinkRecordMapper.java (best guess)
### The error may involve com.campus.water.mapper.DrinkRecordMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO drink_record (dispenser_id, drink, time) VALUES (?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`))
; Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`)); nested exception is java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`))
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`))
### The error may exist in com/campus/water/mapper/DrinkRecordMapper.java (best guess)
### The error may involve com.campus.water.mapper.DrinkRecordMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO drink_record (dispenser_id, drink, time) VALUES (?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`))
; Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`)); nested exception is java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`))
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:251)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at jdk.proxy2/jdk.proxy2.$Proxy58.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:142)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy2/jdk.proxy2.$Proxy65.insert(Unknown Source)
	at com.campus.water.service.MqttService.handleRidData(MqttService.java:222)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`))
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:118)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:916)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:354)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 12 common frames omitted
2025-05-26 14:24:19.222 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubIDdata] 的消息: {"id":12345}
2025-05-26 14:24:19.223 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机 [12345] 的饮水记录列表查询请求...
2025-05-26 14:24:19.235 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subRIDdata]: []
2025-05-26 14:24:19.242 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 14:24:19.243 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 的饮水记录列表查询结果: 0条记录
2025-05-26 14:24:19.244 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: []
2025-05-26 14:24:19.245 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: can not cast to JSONObject.
com.alibaba.fastjson.JSONException: can not cast to JSONObject.
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:260)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:154)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class com.alibaba.fastjson.JSONArray cannot be cast to class com.alibaba.fastjson.JSONObject (com.alibaba.fastjson.JSONArray and com.alibaba.fastjson.JSONObject are in unnamed module of loader 'app')
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:258)
	... 5 common frames omitted
2025-05-26 14:24:22.061 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"李想"}
2025-05-26 14:24:22.062 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录列表查询请求...
2025-05-26 14:24:22.067 [MQTT Call: campus-water-server] WARN  com.campus.water.service.MqttService - 未找到学生 [李想] 的饮水卡信息
2025-05-26 14:24:22.069 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: {"error":"饮水卡不存在"}
2025-05-26 14:24:22.074 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 14:24:39.449 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"14:24:37","drink":150}
2025-05-26 14:24:39.450 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 14:24:39.450 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":"93 27 68 EC","time":"14:24:37","drink":150}
2025-05-26 14:24:39.450 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - cardId: 93 27 68 EC, drink: 150, time: 14:24:37
2025-05-26 14:24:39.454 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 准备保存饮水记录: DrinkRecord(dispenserId=1, drink=150, time=14:24:37)
2025-05-26 14:24:39.462 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水记录数据失败: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`))
### The error may exist in com/campus/water/mapper/DrinkRecordMapper.java (best guess)
### The error may involve com.campus.water.mapper.DrinkRecordMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO drink_record (dispenser_id, drink, time) VALUES (?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`))
; Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`)); nested exception is java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`))
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`))
### The error may exist in com/campus/water/mapper/DrinkRecordMapper.java (best guess)
### The error may involve com.campus.water.mapper.DrinkRecordMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO drink_record (dispenser_id, drink, time) VALUES (?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`))
; Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`)); nested exception is java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`))
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:251)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at jdk.proxy2/jdk.proxy2.$Proxy58.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:142)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy2/jdk.proxy2.$Proxy65.insert(Unknown Source)
	at com.campus.water.service.MqttService.handleRidData(MqttService.java:222)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`campus_water_system`.`drink_record`, CONSTRAINT `drink_record_ibfk_1` FOREIGN KEY (`dispenser_id`) REFERENCES `water_dispenser` (`id`))
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:118)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:916)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:354)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 12 common frames omitted
2025-05-26 14:26:17.283 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 14:26:17.295 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 14:26:24.086 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 39732 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 14:26:24.088 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 14:26:25.579 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 14:26:25.594 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 14:26:25.596 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 14:26:25.596 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 14:26:25.718 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 14:26:25.719 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1587 ms
2025-05-26 14:26:25.929 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 14:26:26.222 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 14:26:26.407 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 14:26:26.777 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 14:26:26.793 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 14:26:27.404 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 14:26:27.428 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 14:26:27.450 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.915 seconds (JVM running for 4.696)
2025-05-26 14:26:55.214 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {"id":12345,"TDS":132,"locate":"libray","status":"0"}
2025-05-26 14:26:55.308 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 14:26:55.359 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 已存在，更新数据
2025-05-26 14:26:55.366 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据更新成功: WaterDispenser(id=12345, locate=libray, tds=132, status=0, tip=null, time=null)
2025-05-26 14:29:45.673 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"14:29:43","drink":0}
2025-05-26 14:29:45.674 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 14:29:45.688 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":"93 27 68 EC","time":"14:29:43","drink":0}
2025-05-26 14:29:45.688 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - id: 93 27 68 EC, drink: 0, time: 14:29:43
2025-05-26 14:29:45.692 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [1] 不存在，创建新记录
2025-05-26 14:29:45.723 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机记录创建成功: WaterDispenser(id=1, locate=默认位置, tds=0, status=1, tip=null, time=14:29:43)
2025-05-26 14:29:45.734 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 准备保存饮水记录: DrinkRecord(dispenserId=1, drink=0, time=14:29:43)
2025-05-26 14:29:45.743 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水记录保存成功: DrinkRecord(dispenserId=1, drink=0, time=14:29:43)
2025-05-26 14:29:58.682 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"14:29:56","drink":250}
2025-05-26 14:29:58.682 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 14:29:58.682 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":"93 27 68 EC","time":"14:29:56","drink":250}
2025-05-26 14:29:58.682 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - id: 93 27 68 EC, drink: 250, time: 14:29:56
2025-05-26 14:29:58.687 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 准备保存饮水记录: DrinkRecord(dispenserId=1, drink=250, time=14:29:56)
2025-05-26 14:29:58.699 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水记录保存成功: DrinkRecord(dispenserId=1, drink=250, time=14:29:56)
2025-05-26 14:30:03.479 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubIDdata] 的消息: {"id":12345}
2025-05-26 14:30:03.479 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机 [12345] 的饮水记录列表查询请求...
2025-05-26 14:30:03.486 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subRIDdata]: []
2025-05-26 14:30:03.491 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 14:30:03.491 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 的饮水记录列表查询结果: 0条记录
2025-05-26 14:30:03.493 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: []
2025-05-26 14:30:03.496 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: can not cast to JSONObject.
com.alibaba.fastjson.JSONException: can not cast to JSONObject.
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:260)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:154)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class com.alibaba.fastjson.JSONArray cannot be cast to class com.alibaba.fastjson.JSONObject (com.alibaba.fastjson.JSONArray and com.alibaba.fastjson.JSONObject are in unnamed module of loader 'app')
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:258)
	... 5 common frames omitted
2025-05-26 14:30:08.354 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"李想"}
2025-05-26 14:30:08.354 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录列表查询请求...
2025-05-26 14:30:08.365 [MQTT Call: campus-water-server] WARN  com.campus.water.service.MqttService - 未找到学生 [李想] 的饮水卡信息
2025-05-26 14:30:08.366 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: {"error":"饮水卡不存在"}
2025-05-26 14:30:08.374 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 14:34:31.502 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {"id":12345,"TDS":130,"locate":"libray","status":"0"}
2025-05-26 14:34:31.503 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 14:34:31.508 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 已存在，更新数据
2025-05-26 14:34:31.516 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据更新成功: WaterDispenser(id=12345, locate=libray, tds=130, status=0, tip=null, time=null)
2025-05-26 14:36:58.809 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 14:36:58.848 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 14:37:05.988 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 53640 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 14:37:05.991 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 14:37:07.414 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 14:37:07.424 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 14:37:07.428 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 14:37:07.430 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 14:37:07.598 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 14:37:07.599 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1563 ms
2025-05-26 14:37:07.805 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 14:37:07.968 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 14:37:08.181 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 14:37:08.540 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 14:37:08.549 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 14:37:09.083 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 14:37:09.130 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 14:37:09.155 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.838 seconds (JVM running for 4.678)
2025-05-26 14:42:11.231 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 14:42:11.381 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 14:42:20.445 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 43184 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 14:42:20.447 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 14:42:21.968 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 14:42:21.983 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 14:42:21.986 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 14:42:21.987 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 14:42:22.098 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 14:42:22.099 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1591 ms
2025-05-26 14:42:22.274 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 14:42:22.583 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 14:42:22.838 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 14:42:23.233 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 14:42:23.246 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 14:42:23.645 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 14:42:23.672 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 14:42:23.683 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.822 seconds (JVM running for 4.756)
2025-05-26 14:46:30.113 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 14:46:30.138 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 14:46:36.357 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 54440 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 14:46:36.360 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 14:46:37.929 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 14:46:37.955 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 14:46:37.958 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 14:46:37.959 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 14:46:38.241 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 14:46:38.242 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1840 ms
2025-05-26 14:46:38.514 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 14:46:38.807 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 14:46:39.048 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 14:46:39.416 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 14:46:39.426 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 14:46:40.054 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 14:46:40.103 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 14:46:40.125 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 4.304 seconds (JVM running for 6.166)
2025-05-26 14:48:13.944 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 14:48:13.957 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 14:48:18.485 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 21648 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 14:48:18.488 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 14:48:20.193 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 14:48:20.212 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 14:48:20.214 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 14:48:20.214 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 14:48:20.399 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 14:48:20.400 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1864 ms
2025-05-26 14:48:20.553 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 14:48:20.825 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 14:48:21.067 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 14:48:21.417 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 14:48:21.431 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 14:48:21.854 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 14:48:21.878 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 14:48:21.891 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.945 seconds (JVM running for 4.89)
2025-05-26 14:48:28.965 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {"id":12345,"TDS":130,"locate":"libray","status":"0"}
2025-05-26 14:48:29.113 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 14:48:29.317 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据保存成功: WaterDispenser(id=12345, locate=libray, tds=130, status=0, tip=null, time=null)
2025-05-26 14:49:26.836 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 14:49:26.849 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 14:49:30.564 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 55672 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 14:49:30.567 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 14:49:32.075 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 14:49:32.085 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 14:49:32.088 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 14:49:32.089 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 14:49:32.184 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 14:49:32.185 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1575 ms
2025-05-26 14:49:32.347 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 14:49:32.634 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 14:49:32.910 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 14:49:33.279 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 14:49:33.292 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 14:49:33.668 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 14:49:33.689 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 14:49:33.701 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.688 seconds (JVM running for 4.487)
2025-05-26 14:49:36.438 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {"id":12345,"TDS":130,"locate":"libray","status":"0"}
2025-05-26 14:49:36.545 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 14:49:36.598 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 已存在，更新数据
2025-05-26 14:49:36.608 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据更新成功: WaterDispenser(id=12345, locate=libray, tds=130, status=0, tip=null, time=null)
2025-05-26 14:50:04.297 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {"id":12345,"TDS":130,"locate":"libray","status":"0"}
2025-05-26 14:50:04.297 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 14:50:04.301 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 已存在，更新数据
2025-05-26 14:50:04.302 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据更新成功: WaterDispenser(id=12345, locate=libray, tds=130, status=0, tip=null, time=null)
2025-05-26 14:50:23.774 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":"93 27 68 EC","time":"14:50:21","drink":250}
2025-05-26 14:50:23.775 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 14:50:23.801 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":"93 27 68 EC","time":"14:50:21","drink":250}
2025-05-26 14:50:23.805 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水记录数据失败: For input string: "93 27 68 EC"
java.lang.NumberFormatException: For input string: "93 27 68 EC"
	at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:67)
	at java.base/java.lang.Integer.parseInt(Integer.java:662)
	at java.base/java.lang.Integer.parseInt(Integer.java:778)
	at com.alibaba.fastjson.util.TypeUtils.castToInt(TypeUtils.java:995)
	at com.alibaba.fastjson.JSONObject.getInteger(JSONObject.java:252)
	at com.campus.water.service.MqttService.handleRidData(MqttService.java:195)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 14:51:07.944 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubIDdata] 的消息: {"id":12345}
2025-05-26 14:51:07.945 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机 [12345] 的饮水记录列表查询请求...
2025-05-26 14:51:07.976 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subRIDdata]: []
2025-05-26 14:51:07.984 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 14:51:07.985 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 的饮水记录列表查询结果: 0条记录
2025-05-26 14:51:07.988 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: []
2025-05-26 14:51:07.991 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: can not cast to JSONObject.
com.alibaba.fastjson.JSONException: can not cast to JSONObject.
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:260)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:154)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class com.alibaba.fastjson.JSONArray cannot be cast to class com.alibaba.fastjson.JSONObject (com.alibaba.fastjson.JSONArray and com.alibaba.fastjson.JSONObject are in unnamed module of loader 'app')
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:258)
	... 5 common frames omitted
2025-05-26 14:54:44.763 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {"id":12345,"TDS":130,"locate":"libray","status":"0"}
2025-05-26 14:54:44.764 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 14:54:44.769 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 已存在，更新数据
2025-05-26 14:54:44.775 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据更新成功: WaterDispenser(id=12345, locate=libray, tds=130, status=0, tip=null, time=null)
2025-05-26 15:03:45.451 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 15:03:45.538 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 15:03:50.955 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 37636 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 15:03:50.959 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 15:03:52.751 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 15:03:52.765 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 15:03:52.768 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 15:03:52.769 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 15:03:52.911 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 15:03:52.911 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1885 ms
2025-05-26 15:03:53.069 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 15:03:53.267 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 15:03:53.490 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 15:03:53.858 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 15:03:53.864 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 15:03:54.430 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 15:03:54.459 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 15:03:54.477 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 4.497 seconds (JVM running for 5.467)
2025-05-26 15:04:03.631 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {
  "id": 12345,
  "TDS": 132,
  "locate": "libray",
  "status": "0"
}
2025-05-26 15:04:03.798 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 15:04:03.876 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据保存成功: WaterDispenser(id=12345, locate=libray, tds=132, status=0, tip=null, time=null)
2025-05-26 15:04:18.811 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {
  "id": "93 27 68 EC",
  "time": "14:16:21",
  "drink": 0
}
2025-05-26 15:04:18.811 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 15:04:18.832 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":"93 27 68 EC","time":"14:16:21","drink":0}
2025-05-26 15:04:18.836 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水记录数据失败: For input string: "93 27 68 EC"
java.lang.NumberFormatException: For input string: "93 27 68 EC"
	at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:67)
	at java.base/java.lang.Integer.parseInt(Integer.java:662)
	at java.base/java.lang.Integer.parseInt(Integer.java:778)
	at com.alibaba.fastjson.util.TypeUtils.castToInt(TypeUtils.java:995)
	at com.alibaba.fastjson.JSONObject.getInteger(JSONObject.java:252)
	at com.campus.water.service.MqttService.handleRidData(MqttService.java:195)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:157)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-26 15:04:53.486 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {
    "time": "09:30:56",
    "id": 12000,
    "drink": 666
  }
2025-05-26 15:04:53.487 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 15:04:53.487 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"time":"09:30:56","id":12000,"drink":666}
2025-05-26 15:04:53.487 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - dispenserId: 12000, drink: 666, time: 09:30:56
2025-05-26 15:04:53.489 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12000] 不存在，创建新记录
2025-05-26 15:04:53.499 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机记录创建成功: WaterDispenser(id=12000, locate=未知位置, tds=未知, status=1, tip=null, time=09:30:56)
2025-05-26 15:04:53.505 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 准备保存饮水记录: DrinkRecord(dispenserId=12000, drink=666, time=09:30:56)
2025-05-26 15:04:53.515 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水记录保存成功: DrinkRecord(dispenserId=12000, drink=666, time=09:30:56)
2025-05-26 15:07:24.261 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subIDCard] 的消息: {
  "id": "D3 F5 BB 27",
  "drink": 0,
  "time": "14:16:21"
}
2025-05-26 15:07:24.262 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水卡数据...
2025-05-26 15:07:24.293 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡数据保存成功: WaterCard(id=D3 F5 BB 27, name=张三, time=14:16:21, drink=0)
2025-05-26 15:07:25.863 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subIDCard] 的消息: {
  "id": "D3 F5 BB 27",
  "drink": 0,
  "time": "14:16:21"
}
2025-05-26 15:07:25.865 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水卡数据...
2025-05-26 15:07:25.870 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡 [D3 F5 BB 27] 已存在，更新数据
2025-05-26 15:07:25.874 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡数据更新成功: WaterCard(id=D3 F5 BB 27, name=张三, time=14:16:21, drink=0)
2025-05-26 15:08:01.517 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 15:08:01.544 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 15:08:06.035 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 34396 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 15:08:06.039 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 15:08:07.392 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 15:08:07.408 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 15:08:07.411 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 15:08:07.412 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 15:08:07.601 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 15:08:07.601 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1515 ms
2025-05-26 15:08:07.777 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 15:08:08.031 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 15:08:08.216 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 15:08:08.598 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 15:08:08.619 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 15:08:09.159 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 15:08:09.193 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 15:08:09.206 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.664 seconds (JVM running for 4.399)
2025-05-26 15:09:23.149 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {"id":12345,"TDS":130,"locate":"libray","status":"0"}
2025-05-26 15:09:23.248 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 15:09:23.328 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 已存在，更新数据
2025-05-26 15:09:23.341 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据更新成功: WaterDispenser(id=12345, locate=libray, tds=130, status=0, tip=null, time=null)
2025-05-26 15:09:39.044 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":12345,"drink":0,"time":"15:09:39"}
2025-05-26 15:09:39.044 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 15:09:39.059 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":12345,"time":"15:09:39","drink":0}
2025-05-26 15:09:39.060 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - dispenserId: 12345, drink: 0, time: 15:09:39
2025-05-26 15:09:39.068 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 准备保存饮水记录: DrinkRecord(dispenserId=12345, drink=0, time=15:09:39)
2025-05-26 15:09:39.079 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水记录保存成功: DrinkRecord(dispenserId=12345, drink=0, time=15:09:39)
2025-05-26 15:09:41.622 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: {"id":"93 27 68 EC","time":"15:09:39","drink":0}
2025-05-26 15:09:41.623 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水卡数据...
2025-05-26 15:09:41.634 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡数据保存成功: WaterCard(id=93 27 68 EC, name=李想, time=15:09:39, drink=0)
2025-05-26 15:09:51.045 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":12345,"drink":200,"time":"15:09:51"}
2025-05-26 15:09:51.045 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 15:09:51.046 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":12345,"time":"15:09:51","drink":200}
2025-05-26 15:09:51.046 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - dispenserId: 12345, drink: 200, time: 15:09:51
2025-05-26 15:09:51.050 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 准备保存饮水记录: DrinkRecord(dispenserId=12345, drink=200, time=15:09:51)
2025-05-26 15:09:51.058 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水记录保存成功: DrinkRecord(dispenserId=12345, drink=200, time=15:09:51)
2025-05-26 15:09:51.768 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubIDdata] 的消息: {"id":12345}
2025-05-26 15:09:51.769 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机 [12345] 的饮水记录列表查询请求...
2025-05-26 15:09:51.781 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subRIDdata]: [{"id":12345,"time":"15:09:39","drink":0},{"id":12345,"time":"15:09:51","drink":200}]
2025-05-26 15:09:51.790 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 15:09:51.790 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 的饮水记录列表查询结果: 2条记录
2025-05-26 15:09:51.793 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: [{"id":12345,"time":"15:09:39","drink":0},{"id":12345,"time":"15:09:51","drink":200}]
2025-05-26 15:09:51.800 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: can not cast to JSONObject.
com.alibaba.fastjson.JSONException: can not cast to JSONObject.
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:260)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:154)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class com.alibaba.fastjson.JSONArray cannot be cast to class com.alibaba.fastjson.JSONObject (com.alibaba.fastjson.JSONArray and com.alibaba.fastjson.JSONObject are in unnamed module of loader 'app')
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:258)
	... 5 common frames omitted
2025-05-26 15:09:53.628 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: {"id":"93 27 68 EC","time":"15:09:51","drink":200}
2025-05-26 15:09:53.630 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水卡数据...
2025-05-26 15:09:53.636 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡 [93 27 68 EC] 已存在，更新数据
2025-05-26 15:09:53.648 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡数据更新成功: WaterCard(id=93 27 68 EC, name=李想, time=15:09:51, drink=200)
2025-05-26 15:10:01.192 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"李想"}
2025-05-26 15:10:01.193 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录列表查询请求...
2025-05-26 15:10:01.200 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":"93 27 68 EC","time":"15:09:51","drink":200}]
2025-05-26 15:10:01.205 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 15:10:01.206 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [李想] 的饮水记录列表查询结果: 1条记录
2025-05-26 15:10:01.208 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: [{"id":"93 27 68 EC","time":"15:09:51","drink":200}]
2025-05-26 15:10:01.209 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: can not cast to JSONObject.
com.alibaba.fastjson.JSONException: can not cast to JSONObject.
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:260)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:154)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class com.alibaba.fastjson.JSONArray cannot be cast to class com.alibaba.fastjson.JSONObject (com.alibaba.fastjson.JSONArray and com.alibaba.fastjson.JSONObject are in unnamed module of loader 'app')
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:258)
	... 5 common frames omitted
2025-05-26 15:10:05.690 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"张三"}
2025-05-26 15:10:05.691 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [张三] 的饮水记录列表查询请求...
2025-05-26 15:10:05.695 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":"D3 F5 BB 27","time":"14:16:21","drink":0}]
2025-05-26 15:10:05.715 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 15:10:05.715 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [张三] 的饮水记录列表查询结果: 1条记录
2025-05-26 15:10:05.717 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: [{"id":"D3 F5 BB 27","time":"14:16:21","drink":0}]
2025-05-26 15:10:05.718 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: can not cast to JSONObject.
com.alibaba.fastjson.JSONException: can not cast to JSONObject.
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:260)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:154)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class com.alibaba.fastjson.JSONArray cannot be cast to class com.alibaba.fastjson.JSONObject (com.alibaba.fastjson.JSONArray and com.alibaba.fastjson.JSONObject are in unnamed module of loader 'app')
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:258)
	... 5 common frames omitted
2025-05-26 15:10:21.524 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubIDdata] 的消息: {"id":12345}
2025-05-26 15:10:21.525 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机 [12345] 的饮水记录列表查询请求...
2025-05-26 15:10:21.540 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subRIDdata]: [{"id":12345,"time":"15:09:39","drink":0},{"id":12345,"time":"15:09:51","drink":200}]
2025-05-26 15:10:21.559 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 15:10:21.561 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 的饮水记录列表查询结果: 2条记录
2025-05-26 15:10:21.569 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: [{"id":12345,"time":"15:09:39","drink":0},{"id":12345,"time":"15:09:51","drink":200}]
2025-05-26 15:10:21.571 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: can not cast to JSONObject.
com.alibaba.fastjson.JSONException: can not cast to JSONObject.
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:260)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:154)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class com.alibaba.fastjson.JSONArray cannot be cast to class com.alibaba.fastjson.JSONObject (com.alibaba.fastjson.JSONArray and com.alibaba.fastjson.JSONObject are in unnamed module of loader 'app')
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:258)
	... 5 common frames omitted
2025-05-26 15:10:30.042 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":12345,"drink":0,"time":"15:10:30"}
2025-05-26 15:10:30.042 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 15:10:30.042 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":12345,"time":"15:10:30","drink":0}
2025-05-26 15:10:30.042 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - dispenserId: 12345, drink: 0, time: 15:10:30
2025-05-26 15:10:30.048 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 准备保存饮水记录: DrinkRecord(dispenserId=12345, drink=0, time=15:10:30)
2025-05-26 15:10:30.056 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水记录保存成功: DrinkRecord(dispenserId=12345, drink=0, time=15:10:30)
2025-05-26 15:10:30.962 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"李想"}
2025-05-26 15:10:30.962 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录列表查询请求...
2025-05-26 15:10:30.966 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":"93 27 68 EC","time":"15:09:51","drink":200}]
2025-05-26 15:10:30.977 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 15:10:30.977 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [李想] 的饮水记录列表查询结果: 1条记录
2025-05-26 15:10:30.979 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: [{"id":"93 27 68 EC","time":"15:09:51","drink":200}]
2025-05-26 15:10:30.980 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: can not cast to JSONObject.
com.alibaba.fastjson.JSONException: can not cast to JSONObject.
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:260)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:154)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class com.alibaba.fastjson.JSONArray cannot be cast to class com.alibaba.fastjson.JSONObject (com.alibaba.fastjson.JSONArray and com.alibaba.fastjson.JSONObject are in unnamed module of loader 'app')
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:258)
	... 5 common frames omitted
2025-05-26 15:10:32.619 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: {"id":"93 27 68 EC","time":"15:10:30","drink":0}
2025-05-26 15:10:32.620 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水卡数据...
2025-05-26 15:10:32.623 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡 [93 27 68 EC] 已存在，更新数据
2025-05-26 15:10:32.630 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡数据更新成功: WaterCard(id=93 27 68 EC, name=李想, time=15:10:30, drink=0)
2025-05-26 15:10:46.247 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"张三"}
2025-05-26 15:10:46.248 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [张三] 的饮水记录列表查询请求...
2025-05-26 15:10:46.251 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":"D3 F5 BB 27","time":"14:16:21","drink":0}]
2025-05-26 15:10:46.262 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 15:10:46.263 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [张三] 的饮水记录列表查询结果: 1条记录
2025-05-26 15:10:46.264 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: [{"id":"D3 F5 BB 27","time":"14:16:21","drink":0}]
2025-05-26 15:10:46.264 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: can not cast to JSONObject.
com.alibaba.fastjson.JSONException: can not cast to JSONObject.
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:260)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:154)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class com.alibaba.fastjson.JSONArray cannot be cast to class com.alibaba.fastjson.JSONObject (com.alibaba.fastjson.JSONArray and com.alibaba.fastjson.JSONObject are in unnamed module of loader 'app')
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:258)
	... 5 common frames omitted
2025-05-26 15:10:53.516 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"张三"}
2025-05-26 15:10:53.516 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [张三] 的饮水记录列表查询请求...
2025-05-26 15:10:53.524 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":"D3 F5 BB 27","time":"14:16:21","drink":0}]
2025-05-26 15:10:53.542 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 15:10:53.543 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [张三] 的饮水记录列表查询结果: 1条记录
2025-05-26 15:10:53.559 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: [{"id":"D3 F5 BB 27","time":"14:16:21","drink":0}]
2025-05-26 15:10:53.560 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: can not cast to JSONObject.
com.alibaba.fastjson.JSONException: can not cast to JSONObject.
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:260)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:154)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class com.alibaba.fastjson.JSONArray cannot be cast to class com.alibaba.fastjson.JSONObject (com.alibaba.fastjson.JSONArray and com.alibaba.fastjson.JSONObject are in unnamed module of loader 'app')
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:258)
	... 5 common frames omitted
2025-05-26 15:10:59.928 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubIDdata] 的消息: {"id":12345}
2025-05-26 15:10:59.929 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机 [12345] 的饮水记录列表查询请求...
2025-05-26 15:10:59.947 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subRIDdata]: [{"id":12345,"time":"15:09:39","drink":0},{"id":12345,"time":"15:09:51","drink":200},{"id":12345,"time":"15:10:30","drink":0}]
2025-05-26 15:10:59.966 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 15:10:59.970 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 的饮水记录列表查询结果: 3条记录
2025-05-26 15:10:59.980 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: [{"id":12345,"time":"15:09:39","drink":0},{"id":12345,"time":"15:09:51","drink":200},{"id":12345,"time":"15:10:30","drink":0}]
2025-05-26 15:10:59.982 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: can not cast to JSONObject.
com.alibaba.fastjson.JSONException: can not cast to JSONObject.
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:260)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:154)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class com.alibaba.fastjson.JSONArray cannot be cast to class com.alibaba.fastjson.JSONObject (com.alibaba.fastjson.JSONArray and com.alibaba.fastjson.JSONObject are in unnamed module of loader 'app')
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:258)
	... 5 common frames omitted
2025-05-26 15:11:13.657 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"李想"}
2025-05-26 15:11:13.657 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录列表查询请求...
2025-05-26 15:11:13.662 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":"93 27 68 EC","time":"15:10:30","drink":0}]
2025-05-26 15:11:13.671 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 15:11:13.671 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [李想] 的饮水记录列表查询结果: 1条记录
2025-05-26 15:11:13.672 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: [{"id":"93 27 68 EC","time":"15:10:30","drink":0}]
2025-05-26 15:11:13.673 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: can not cast to JSONObject.
com.alibaba.fastjson.JSONException: can not cast to JSONObject.
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:260)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:154)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class com.alibaba.fastjson.JSONArray cannot be cast to class com.alibaba.fastjson.JSONObject (com.alibaba.fastjson.JSONArray and com.alibaba.fastjson.JSONObject are in unnamed module of loader 'app')
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:258)
	... 5 common frames omitted
2025-05-26 15:11:14.042 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":12345,"drink":0,"time":"15:11:14"}
2025-05-26 15:11:14.042 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 15:11:14.043 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":12345,"time":"15:11:14","drink":0}
2025-05-26 15:11:14.044 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - dispenserId: 12345, drink: 0, time: 15:11:14
2025-05-26 15:11:14.049 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 准备保存饮水记录: DrinkRecord(dispenserId=12345, drink=0, time=15:11:14)
2025-05-26 15:11:14.056 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水记录保存成功: DrinkRecord(dispenserId=12345, drink=0, time=15:11:14)
2025-05-26 15:11:16.617 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: {"id":"93 27 68 EC","time":"15:11:14","drink":0}
2025-05-26 15:11:16.617 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水卡数据...
2025-05-26 15:11:16.623 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡 [93 27 68 EC] 已存在，更新数据
2025-05-26 15:11:16.632 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡数据更新成功: WaterCard(id=93 27 68 EC, name=李想, time=15:11:14, drink=0)
2025-05-26 15:11:17.108 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"张三"}
2025-05-26 15:11:17.109 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [张三] 的饮水记录列表查询请求...
2025-05-26 15:11:17.111 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":"D3 F5 BB 27","time":"14:16:21","drink":0}]
2025-05-26 15:11:17.118 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 15:11:17.119 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [张三] 的饮水记录列表查询结果: 1条记录
2025-05-26 15:11:17.119 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: [{"id":"D3 F5 BB 27","time":"14:16:21","drink":0}]
2025-05-26 15:11:17.120 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: can not cast to JSONObject.
com.alibaba.fastjson.JSONException: can not cast to JSONObject.
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:260)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:154)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class com.alibaba.fastjson.JSONArray cannot be cast to class com.alibaba.fastjson.JSONObject (com.alibaba.fastjson.JSONArray and com.alibaba.fastjson.JSONObject are in unnamed module of loader 'app')
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:258)
	... 5 common frames omitted
2025-05-26 15:11:21.180 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"李想"}
2025-05-26 15:11:21.181 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录列表查询请求...
2025-05-26 15:11:21.186 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":"93 27 68 EC","time":"15:11:14","drink":0}]
2025-05-26 15:11:21.195 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 15:11:21.196 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [李想] 的饮水记录列表查询结果: 1条记录
2025-05-26 15:11:21.197 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: [{"id":"93 27 68 EC","time":"15:11:14","drink":0}]
2025-05-26 15:11:21.198 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: can not cast to JSONObject.
com.alibaba.fastjson.JSONException: can not cast to JSONObject.
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:260)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:154)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class com.alibaba.fastjson.JSONArray cannot be cast to class com.alibaba.fastjson.JSONObject (com.alibaba.fastjson.JSONArray and com.alibaba.fastjson.JSONObject are in unnamed module of loader 'app')
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:258)
	... 5 common frames omitted
2025-05-26 15:11:26.542 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"李想"}
2025-05-26 15:11:26.542 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录列表查询请求...
2025-05-26 15:11:26.546 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":"93 27 68 EC","time":"15:11:14","drink":0}]
2025-05-26 15:11:26.589 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 15:11:26.589 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [李想] 的饮水记录列表查询结果: 1条记录
2025-05-26 15:11:26.604 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: [{"id":"93 27 68 EC","time":"15:11:14","drink":0}]
2025-05-26 15:11:26.605 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: can not cast to JSONObject.
com.alibaba.fastjson.JSONException: can not cast to JSONObject.
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:260)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:154)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class com.alibaba.fastjson.JSONArray cannot be cast to class com.alibaba.fastjson.JSONObject (com.alibaba.fastjson.JSONArray and com.alibaba.fastjson.JSONObject are in unnamed module of loader 'app')
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:258)
	... 5 common frames omitted
2025-05-26 15:11:34.611 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"李想"}
2025-05-26 15:11:34.611 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录列表查询请求...
2025-05-26 15:11:34.614 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":"93 27 68 EC","time":"15:11:14","drink":0}]
2025-05-26 15:11:34.624 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 15:11:34.624 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [李想] 的饮水记录列表查询结果: 1条记录
2025-05-26 15:11:34.626 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: [{"id":"93 27 68 EC","time":"15:11:14","drink":0}]
2025-05-26 15:11:34.626 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理消息时发生错误: can not cast to JSONObject.
com.alibaba.fastjson.JSONException: can not cast to JSONObject.
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:260)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:154)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class com.alibaba.fastjson.JSONArray cannot be cast to class com.alibaba.fastjson.JSONObject (com.alibaba.fastjson.JSONArray and com.alibaba.fastjson.JSONObject are in unnamed module of loader 'app')
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:258)
	... 5 common frames omitted
2025-05-26 15:12:08.038 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":12345,"drink":0,"time":"15:12:08"}
2025-05-26 15:12:08.038 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 15:12:08.038 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":12345,"time":"15:12:08","drink":0}
2025-05-26 15:12:08.039 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - dispenserId: 12345, drink: 0, time: 15:12:08
2025-05-26 15:12:08.044 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 准备保存饮水记录: DrinkRecord(dispenserId=12345, drink=0, time=15:12:08)
2025-05-26 15:12:08.052 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水记录保存成功: DrinkRecord(dispenserId=12345, drink=0, time=15:12:08)
2025-05-26 15:12:10.614 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: {"id":"93 27 68 EC","time":"15:12:08","drink":0}
2025-05-26 15:12:10.614 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水卡数据...
2025-05-26 15:12:10.632 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡 [93 27 68 EC] 已存在，更新数据
2025-05-26 15:12:10.646 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡数据更新成功: WaterCard(id=93 27 68 EC, name=李想, time=15:12:08, drink=0)
2025-05-26 15:12:39.033 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":12345,"drink":0,"time":"15:12:39"}
2025-05-26 15:12:39.033 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 15:12:39.034 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":12345,"time":"15:12:39","drink":0}
2025-05-26 15:12:39.034 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - dispenserId: 12345, drink: 0, time: 15:12:39
2025-05-26 15:12:39.041 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 准备保存饮水记录: DrinkRecord(dispenserId=12345, drink=0, time=15:12:39)
2025-05-26 15:12:39.050 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水记录保存成功: DrinkRecord(dispenserId=12345, drink=0, time=15:12:39)
2025-05-26 15:12:41.610 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: {"id":"93 27 68 EC","time":"15:12:39","drink":0}
2025-05-26 15:12:41.610 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水卡数据...
2025-05-26 15:12:41.614 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡 [93 27 68 EC] 已存在，更新数据
2025-05-26 15:12:41.623 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡数据更新成功: WaterCard(id=93 27 68 EC, name=李想, time=15:12:39, drink=0)
2025-05-26 15:13:00.147 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":12345,"drink":0,"time":"15:13:00"}
2025-05-26 15:13:00.148 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 15:13:00.148 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":12345,"time":"15:13:00","drink":0}
2025-05-26 15:13:00.148 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - dispenserId: 12345, drink: 0, time: 15:13:00
2025-05-26 15:13:00.153 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 准备保存饮水记录: DrinkRecord(dispenserId=12345, drink=0, time=15:13:00)
2025-05-26 15:13:00.174 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水记录保存成功: DrinkRecord(dispenserId=12345, drink=0, time=15:13:00)
2025-05-26 15:13:02.608 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: {"id":"93 27 68 EC","time":"15:13:00","drink":0}
2025-05-26 15:13:02.609 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水卡数据...
2025-05-26 15:13:02.616 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡 [93 27 68 EC] 已存在，更新数据
2025-05-26 15:13:02.626 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡数据更新成功: WaterCard(id=93 27 68 EC, name=李想, time=15:13:00, drink=0)
2025-05-26 15:13:57.037 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subRIDdata] 的消息: {"id":12345,"drink":200,"time":"15:13:57"}
2025-05-26 15:13:57.037 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 15:13:57.038 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 接收到的JSON数据: {"id":12345,"time":"15:13:57","drink":200}
2025-05-26 15:13:57.038 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 解析出的数据 - dispenserId: 12345, drink: 200, time: 15:13:57
2025-05-26 15:13:57.044 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 准备保存饮水记录: DrinkRecord(dispenserId=12345, drink=200, time=15:13:57)
2025-05-26 15:13:57.052 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水记录保存成功: DrinkRecord(dispenserId=12345, drink=200, time=15:13:57)
2025-05-26 15:13:59.617 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subCard] 的消息: {"id":"93 27 68 EC","time":"15:13:57","drink":200}
2025-05-26 15:13:59.617 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水卡数据...
2025-05-26 15:13:59.621 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡 [93 27 68 EC] 已存在，更新数据
2025-05-26 15:13:59.635 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水卡数据更新成功: WaterCard(id=93 27 68 EC, name=李想, time=15:13:57, drink=200)
2025-05-26 16:41:23.073 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 16:41:23.105 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 16:41:33.219 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 53612 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 16:41:33.222 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 16:41:34.942 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 16:41:34.951 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 16:41:34.952 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 16:41:34.953 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 16:41:35.048 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 16:41:35.048 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1731 ms
2025-05-26 16:41:35.250 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 16:41:35.460 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 16:41:35.662 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 16:41:36.058 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 16:41:36.076 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 16:41:36.617 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 16:41:36.658 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 16:41:36.686 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 4.162 seconds (JVM running for 5.163)
2025-05-26 16:43:31.953 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息:      {
         "id": 12345,
         "locate": "教学楼A区",
         "TDS": "合格",
         "status": 0
     }
2025-05-26 16:43:32.264 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 16:43:32.607 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水机数据失败: 
### Error updating database.  Cause: java.sql.SQLSyntaxErrorException: Unknown column 'time' in 'field list'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status, time) VALUES (?, ?, ?, ?, ?)
### Cause: java.sql.SQLSyntaxErrorException: Unknown column 'time' in 'field list'
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Unknown column 'time' in 'field list'
org.springframework.jdbc.BadSqlGrammarException: 
### Error updating database.  Cause: java.sql.SQLSyntaxErrorException: Unknown column 'time' in 'field list'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status, time) VALUES (?, ?, ?, ?, ?)
### Cause: java.sql.SQLSyntaxErrorException: Unknown column 'time' in 'field list'
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Unknown column 'time' in 'field list'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:239)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at jdk.proxy2/jdk.proxy2.$Proxy58.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:142)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy2/jdk.proxy2.$Proxy63.insert(Unknown Source)
	at com.campus.water.service.MqttService.handleDispenserData(MqttService.java:199)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:156)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'time' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:121)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:916)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:354)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 12 common frames omitted
2025-05-26 16:45:16.567 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息:      {
         "id": 12345,
         "locate": "教学楼A区",
         "TDS": "合格",
         "status": 0
     }
2025-05-26 16:45:16.568 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 16:45:16.577 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水机数据失败: 
### Error updating database.  Cause: java.sql.SQLSyntaxErrorException: Unknown column 'time' in 'field list'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status, time) VALUES (?, ?, ?, ?, ?)
### Cause: java.sql.SQLSyntaxErrorException: Unknown column 'time' in 'field list'
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Unknown column 'time' in 'field list'
org.springframework.jdbc.BadSqlGrammarException: 
### Error updating database.  Cause: java.sql.SQLSyntaxErrorException: Unknown column 'time' in 'field list'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status, time) VALUES (?, ?, ?, ?, ?)
### Cause: java.sql.SQLSyntaxErrorException: Unknown column 'time' in 'field list'
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Unknown column 'time' in 'field list'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:239)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at jdk.proxy2/jdk.proxy2.$Proxy58.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:142)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy2/jdk.proxy2.$Proxy63.insert(Unknown Source)
	at com.campus.water.service.MqttService.handleDispenserData(MqttService.java:199)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:156)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'time' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:121)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:916)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:354)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 12 common frames omitted
2025-05-26 16:45:29.119 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 16:45:29.136 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 16:45:37.133 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 22616 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 16:45:37.135 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 16:45:38.752 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 16:45:38.763 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 16:45:38.765 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 16:45:38.765 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 16:45:38.942 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 16:45:38.942 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1752 ms
2025-05-26 16:45:39.102 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 16:45:39.306 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 16:45:39.473 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 16:45:39.825 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 16:45:39.838 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 16:45:40.255 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 16:45:40.274 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 16:45:40.286 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.95 seconds (JVM running for 5.145)
2025-05-26 16:45:43.424 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息:      {
         "id": 12345,
         "locate": "教学楼A区",
         "TDS": "合格",
         "status": 0
     }
2025-05-26 16:45:43.610 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 16:45:43.715 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据保存成功: WaterDispenser(id=12345, locate=教学楼A区, tds=合格, status=0)
2025-05-26 16:46:16.482 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subIDCard] 的消息:      {
         "id": "12345",
         "card_id": "93 27 68 EC",
         "time": "09:30:00",
         "drink": 100
     }
2025-05-26 16:46:16.483 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 16:46:16.652 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水记录保存成功: DrinkRecord(id=null, cardId=93 27 68 EC, name=李想, dispenserId=12345, time=09:30:00, drink=100)
2025-05-26 16:46:43.155 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subIDCard] 的消息:      {
         "id": "12000",
         "card_id": "93 27 68 EC",
         "time": "09:30:00",
         "drink": 100
     }
2025-05-26 16:46:43.156 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 16:46:43.168 [MQTT Call: campus-water-server] WARN  com.campus.water.service.MqttService - 饮水机 [12000] 不存在，跳过记录
2025-05-26 16:47:10.821 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息:      {
         "id": 12000,
         "locate": "教学楼A区",
         "TDS": "合格",
         "status": 0
     }
2025-05-26 16:47:10.821 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 16:47:10.830 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据保存成功: WaterDispenser(id=12000, locate=教学楼A区, tds=合格, status=0)
2025-05-26 16:47:38.404 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subIDCard] 的消息:      {
         "id": "12000",
         "card_id": "93 27 68 EC",
         "time": "09:30:00",
         "drink": 100
     }
2025-05-26 16:47:38.405 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 16:47:38.422 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水记录保存成功: DrinkRecord(id=null, cardId=93 27 68 EC, name=李想, dispenserId=12000, time=09:30:00, drink=100)
2025-05-26 16:48:08.081 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息:      {
         "name": "张三"
     }
2025-05-26 16:48:08.082 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [张三] 的饮水记录查询请求...
2025-05-26 16:48:08.088 [MQTT Call: campus-water-server] WARN  com.campus.water.service.MqttService - 未找到学生 [张三] 的饮水记录
2025-05-26 16:48:08.119 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCar]: {"error":"该饮水卡记录不存在"}
2025-05-26 16:48:08.125 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 16:48:30.636 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息:      {
         "name": "李想"
     }
2025-05-26 16:48:30.636 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录查询请求...
2025-05-26 16:48:30.639 [MQTT Call: campus-water-server] WARN  com.campus.water.service.MqttService - 未找到学生 [李想] 的饮水记录
2025-05-26 16:48:30.640 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCar]: {"error":"该饮水卡记录不存在"}
2025-05-26 16:48:30.647 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 16:50:04.747 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息:      {
         "name": "李想"
     }
2025-05-26 16:50:04.747 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录查询请求...
2025-05-26 16:50:04.750 [MQTT Call: campus-water-server] WARN  com.campus.water.service.MqttService - 未找到学生 [李想] 的饮水记录
2025-05-26 16:50:04.750 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCar]: {"error":"该饮水卡记录不存在"}
2025-05-26 16:50:04.755 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 16:51:26.941 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 16:51:26.970 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 16:51:33.931 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 47840 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 16:51:33.933 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 16:51:35.402 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 16:51:35.416 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 16:51:35.419 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 16:51:35.420 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 16:51:35.561 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 16:51:35.562 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1585 ms
2025-05-26 16:51:35.708 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 16:51:35.933 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 16:51:36.144 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 16:51:36.512 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 16:51:36.520 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 16:51:36.959 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 16:51:36.987 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 16:51:37.000 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.785 seconds (JVM running for 4.733)
2025-05-26 16:51:40.924 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息:      {
         "name": "李想"
     }
2025-05-26 16:51:41.038 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录查询请求...
2025-05-26 16:51:41.133 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":"93 27 68 EC","time":"09:30:00","drink":100},{"id":"93 27 68 EC","time":"09:30:00","drink":100}]
2025-05-26 16:51:41.140 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 16:51:41.141 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [李想] 的饮水记录查询结果: 2条记录
2025-05-26 16:52:34.326 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubIdData] 的消息:      {
         "id": "12345"
     }
2025-05-26 16:52:34.327 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机 [12345] 的饮水记录查询请求...
2025-05-26 16:52:34.337 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subRIDdata]: [{"id":12345,"time":"09:30:00","drink":100}]
2025-05-26 16:52:34.342 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 16:52:34.343 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 的饮水记录查询结果: 1条记录
2025-05-26 16:58:16.220 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 16:58:16.237 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 16:58:20.440 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 16336 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 16:58:20.445 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 16:58:21.716 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 16:58:21.726 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 16:58:21.728 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 16:58:21.728 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 16:58:21.819 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 16:58:21.819 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1233 ms
2025-05-26 16:58:21.972 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 16:58:22.301 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 16:58:22.475 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 16:58:22.834 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 16:58:22.842 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 16:58:23.255 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 16:58:23.281 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 16:58:23.297 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.489 seconds (JVM running for 4.383)
2025-05-26 17:02:38.329 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {"id":12345,"TDS":130,"locate":"libray","status":"0"}
2025-05-26 17:02:38.523 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 17:02:38.584 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据保存成功: WaterDispenser(id=12345, locate=libray, tds=130, status=0)
2025-05-26 17:04:57.150 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {"id":12345,"TDS":130,"locate":"libray","status":"0"}
2025-05-26 17:04:57.151 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 17:04:57.292 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水机数据失败: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status) VALUES (?, ?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
; Duplicate entry '12345' for key 'water_dispenser.PRIMARY'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status) VALUES (?, ?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
; Duplicate entry '12345' for key 'water_dispenser.PRIMARY'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at jdk.proxy2/jdk.proxy2.$Proxy58.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:142)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy2/jdk.proxy2.$Proxy63.insert(Unknown Source)
	at com.campus.water.service.MqttService.handleDispenserData(MqttService.java:199)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:156)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:118)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:916)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:354)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 12 common frames omitted
2025-05-26 17:06:13.609 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 17:06:13.634 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 17:06:18.368 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 55348 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 17:06:18.371 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 17:06:19.735 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 17:06:19.748 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 17:06:19.750 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 17:06:19.750 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 17:06:19.857 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 17:06:19.858 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1436 ms
2025-05-26 17:06:20.029 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 17:06:20.251 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 17:06:20.561 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 17:06:20.940 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 17:06:20.949 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 17:06:21.436 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 17:06:21.492 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 17:06:21.514 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.586 seconds (JVM running for 4.579)
2025-05-26 17:07:13.844 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {"id":12345,"TDS":130,"locate":"libray","status":"0"}
2025-05-26 17:07:13.944 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 17:07:13.986 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据保存成功: WaterDispenser(id=12345, locate=libray, tds=130, status=0)
2025-05-26 17:07:28.755 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subIDCard] 的消息: {"id":12345,"drink":150,"time":"17:07:29","card_id":"93 27 68 EC"}
2025-05-26 17:07:28.756 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水记录数据...
2025-05-26 17:07:28.797 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水记录保存成功: DrinkRecord(id=null, cardId=93 27 68 EC, name=李想, dispenserId=12345, time=17:07:29, drink=150)
2025-05-26 17:07:37.437 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"李想"}
2025-05-26 17:07:37.438 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录查询请求...
2025-05-26 17:07:37.482 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":"93 27 68 EC","time":"17:07:29","drink":150}]
2025-05-26 17:07:37.495 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 17:07:37.496 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [李想] 的饮水记录查询结果: 1条记录
2025-05-26 17:07:57.271 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"李想"}
2025-05-26 17:07:57.272 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录查询请求...
2025-05-26 17:07:57.279 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":"93 27 68 EC","time":"17:07:29","drink":150}]
2025-05-26 17:07:57.292 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 17:07:57.292 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [李想] 的饮水记录查询结果: 1条记录
2025-05-26 17:11:57.681 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 17:11:59.309 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 17:12:03.319 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 25176 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 17:12:03.321 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 17:12:04.671 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 17:12:04.686 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 17:12:04.687 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 17:12:04.688 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 17:12:04.865 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 17:12:04.865 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1497 ms
2025-05-26 17:12:05.083 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 17:12:05.317 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 17:12:05.488 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 17:12:05.847 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 17:12:05.852 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 17:12:06.240 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 17:12:06.264 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 17:12:06.286 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.493 seconds (JVM running for 4.433)
2025-05-26 17:12:11.152 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubIdData] 的消息:      {
         "id": "12345"
     }
2025-05-26 17:12:11.247 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机 [12345] 的饮水记录查询请求...
2025-05-26 17:12:11.312 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subRIDdata]: [{"id":12345,"time":"17:07:29","drink":150}]
2025-05-26 17:12:11.316 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 17:12:11.317 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 的饮水记录查询结果: 1条记录
2025-05-26 17:16:01.411 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息:   {
    "name": "李想"
  }
2025-05-26 17:16:01.412 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录查询请求...
2025-05-26 17:16:01.419 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":"93 27 68 EC","time":"17:07:29","drink":150}]
2025-05-26 17:16:01.425 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 17:16:01.425 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [李想] 的饮水记录查询结果: 1条记录
2025-05-26 17:18:27.797 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 17:18:27.821 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 17:18:32.895 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 9920 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 17:18:32.897 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 17:18:34.209 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 17:18:34.217 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 17:18:34.218 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 17:18:34.219 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 17:18:34.312 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 17:18:34.313 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1371 ms
2025-05-26 17:18:34.495 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 17:18:34.697 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 17:18:34.870 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 17:18:35.268 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 17:18:35.280 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 17:18:35.665 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 17:18:35.689 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 17:18:35.707 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.279 seconds (JVM running for 4.201)
2025-05-26 17:18:36.787 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"李想"}
2025-05-26 17:18:36.884 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录查询请求...
2025-05-26 17:18:36.978 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":"93 27 68 EC","time":"17:07:29","drink":150}]
2025-05-26 17:18:36.984 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 17:18:36.984 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [李想] 的饮水记录查询结果: 1条记录
2025-05-26 17:20:42.115 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {
  "id": 12345,
  "TDS": 132,
  "locate": "libray",
  "status": "0"
}
2025-05-26 17:20:42.115 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 17:20:42.403 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水机数据失败: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status) VALUES (?, ?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
; Duplicate entry '12345' for key 'water_dispenser.PRIMARY'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status) VALUES (?, ?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
; Duplicate entry '12345' for key 'water_dispenser.PRIMARY'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at jdk.proxy2/jdk.proxy2.$Proxy58.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:142)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy2/jdk.proxy2.$Proxy63.insert(Unknown Source)
	at com.campus.water.service.MqttService.handleDispenserData(MqttService.java:199)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:156)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:118)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:916)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:354)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 12 common frames omitted
2025-05-26 17:21:00.065 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {
  "id": 12345,
  "TDS": 132,
  "locate": "libray",
  "status": "0"
}
2025-05-26 17:21:00.066 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 17:21:00.091 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水机数据失败: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status) VALUES (?, ?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
; Duplicate entry '12345' for key 'water_dispenser.PRIMARY'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status) VALUES (?, ?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
; Duplicate entry '12345' for key 'water_dispenser.PRIMARY'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at jdk.proxy2/jdk.proxy2.$Proxy58.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:142)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy2/jdk.proxy2.$Proxy63.insert(Unknown Source)
	at com.campus.water.service.MqttService.handleDispenserData(MqttService.java:199)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:156)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:118)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:916)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:354)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 12 common frames omitted
2025-05-26 17:21:32.850 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {
  "id": 12345,
  "TDS": 132,
  "locate": "libray",
  "status": "0"
}
2025-05-26 17:21:32.852 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 17:21:32.859 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水机数据失败: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status) VALUES (?, ?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
; Duplicate entry '12345' for key 'water_dispenser.PRIMARY'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status) VALUES (?, ?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
; Duplicate entry '12345' for key 'water_dispenser.PRIMARY'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at jdk.proxy2/jdk.proxy2.$Proxy58.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:142)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy2/jdk.proxy2.$Proxy63.insert(Unknown Source)
	at com.campus.water.service.MqttService.handleDispenserData(MqttService.java:199)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:156)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:118)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:916)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:354)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 12 common frames omitted
2025-05-26 17:21:49.761 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 17:21:49.771 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 17:21:57.151 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 27692 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 17:21:57.154 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 17:21:58.723 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 17:21:58.733 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 17:21:58.734 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 17:21:58.736 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 17:21:58.866 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 17:21:58.866 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1661 ms
2025-05-26 17:21:59.000 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 17:21:59.340 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 17:21:59.537 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 17:21:59.905 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 17:21:59.910 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 17:22:00.369 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 17:22:00.392 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 17:22:00.404 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.82 seconds (JVM running for 4.62)
2025-05-26 17:22:20.401 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 17:22:20.409 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 17:22:26.352 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 56664 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 17:22:26.356 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 17:22:27.535 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 17:22:27.545 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 17:22:27.548 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 17:22:27.548 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 17:22:27.657 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 17:22:27.657 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1251 ms
2025-05-26 17:22:27.811 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 17:22:28.020 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 17:22:28.184 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 17:22:28.550 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 17:22:28.563 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 17:22:29.041 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 17:22:29.061 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 17:22:29.076 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.325 seconds (JVM running for 4.027)
2025-05-26 17:22:49.179 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"李想"}
2025-05-26 17:22:49.311 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录查询请求...
2025-05-26 17:22:49.401 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":12345,"time":"17:07:29","drink":150}]
2025-05-26 17:22:49.408 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 17:22:49.408 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [李想] 的饮水记录查询结果: 1条记录
2025-05-26 17:23:08.007 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"李想"}
2025-05-26 17:23:08.007 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录查询请求...
2025-05-26 17:23:08.012 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":12345,"time":"17:07:29","drink":150}]
2025-05-26 17:23:08.023 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 17:23:08.023 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [李想] 的饮水记录查询结果: 1条记录
2025-05-26 17:23:24.519 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {
  "id": 12345,
  "TDS": 132,
  "locate": "libray",
  "status": "0"
}
2025-05-26 17:23:24.520 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 17:23:24.724 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水机数据失败: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status) VALUES (?, ?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
; Duplicate entry '12345' for key 'water_dispenser.PRIMARY'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status) VALUES (?, ?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
; Duplicate entry '12345' for key 'water_dispenser.PRIMARY'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at jdk.proxy2/jdk.proxy2.$Proxy58.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:142)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy2/jdk.proxy2.$Proxy63.insert(Unknown Source)
	at com.campus.water.service.MqttService.handleDispenserData(MqttService.java:199)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:156)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:118)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:916)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:354)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 12 common frames omitted
2025-05-26 17:23:50.697 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {
  "id": 12345,
  "TDS": 132,
  "locate": "libray",
  "status": "0"
}
2025-05-26 17:23:50.698 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 17:23:50.702 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水机数据失败: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status) VALUES (?, ?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
; Duplicate entry '12345' for key 'water_dispenser.PRIMARY'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status) VALUES (?, ?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
; Duplicate entry '12345' for key 'water_dispenser.PRIMARY'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at jdk.proxy2/jdk.proxy2.$Proxy58.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:142)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy2/jdk.proxy2.$Proxy63.insert(Unknown Source)
	at com.campus.water.service.MqttService.handleDispenserData(MqttService.java:199)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:156)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:118)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:916)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:354)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 12 common frames omitted
2025-05-26 17:23:55.848 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 17:23:55.865 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 17:24:00.338 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 25136 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 17:24:00.343 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 17:24:01.584 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 17:24:01.591 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 17:24:01.592 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 17:24:01.593 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 17:24:01.668 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 17:24:01.669 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1246 ms
2025-05-26 17:24:01.920 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 17:24:02.238 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 17:24:02.419 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 17:24:02.775 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 17:24:02.789 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 17:24:03.325 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 17:24:03.361 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 17:24:03.381 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.65 seconds (JVM running for 4.318)
2025-05-26 17:24:12.127 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"李想"}
2025-05-26 17:24:12.276 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录查询请求...
2025-05-26 17:24:12.341 [MQTT Call: campus-water-server] WARN  com.campus.water.service.MqttService - 未找到学生 [李想] 的饮水记录
2025-05-26 17:24:12.366 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: {"error":"该饮水卡记录不存在"}
2025-05-26 17:24:12.373 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 17:24:23.627 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {
  "id": 12345,
  "TDS": 132,
  "locate": "libray",
  "status": "0"
}
2025-05-26 17:24:23.628 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 17:24:23.814 [MQTT Call: campus-water-server] ERROR com.campus.water.service.MqttService - 处理饮水机数据失败: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status) VALUES (?, ?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
; Duplicate entry '12345' for key 'water_dispenser.PRIMARY'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
### The error may exist in com/campus/water/mapper/WaterDispenserMapper.java (best guess)
### The error may involve com.campus.water.mapper.WaterDispenserMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO water_dispenser (id, locate, tds, status) VALUES (?, ?, ?, ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
; Duplicate entry '12345' for key 'water_dispenser.PRIMARY'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at jdk.proxy2/jdk.proxy2.$Proxy58.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:142)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy2/jdk.proxy2.$Proxy63.insert(Unknown Source)
	at com.campus.water.service.MqttService.handleDispenserData(MqttService.java:199)
	at com.campus.water.service.MqttService.messageArrived(MqttService.java:156)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.deliverMessage(CommsCallback.java:519)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.handleMessage(CommsCallback.java:417)
	at org.eclipse.paho.client.mqttv3.internal.CommsCallback.run(CommsCallback.java:214)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '12345' for key 'water_dispenser.PRIMARY'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:118)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:916)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:354)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 12 common frames omitted
2025-05-26 17:25:57.621 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 17:25:57.664 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 17:26:05.236 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 49896 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 17:26:05.239 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 17:26:06.619 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 17:26:06.632 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 17:26:06.634 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 17:26:06.634 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 17:26:06.742 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 17:26:06.743 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1440 ms
2025-05-26 17:26:06.997 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 17:26:07.188 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 17:26:07.323 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 17:26:07.691 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 17:26:07.708 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 17:26:08.203 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 17:26:08.228 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 17:26:08.244 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.527 seconds (JVM running for 4.271)
2025-05-26 17:27:16.964 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {
  "id": 12345,
  "TDS": 132,
  "locate": "libray",
  "status": "0"
}
2025-05-26 17:27:17.305 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 17:27:17.505 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 已存在，更新数据
2025-05-26 17:27:17.533 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据更新成功: WaterDispenser(id=12345, locate=libray, tds=132, status=0)
2025-05-26 17:30:48.308 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [subDispenser] 的消息: {
  "id": 12345,
  "TDS": 132,
  "locate": "libray",
  "status": "0"
}
2025-05-26 17:30:48.309 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机数据...
2025-05-26 17:30:48.315 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 已存在，更新数据
2025-05-26 17:30:48.319 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机数据更新成功: WaterDispenser(id=12345, locate=libray, tds=132, status=0)
2025-05-26 17:30:58.758 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"李想"}
2025-05-26 17:30:58.759 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录查询请求...
2025-05-26 17:30:58.784 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":12345,"time":"13:00:00","drink":100}]
2025-05-26 17:30:58.792 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 17:30:58.792 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [李想] 的饮水记录查询结果: 1条记录
2025-05-26 17:38:00.405 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 17:38:00.429 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-26 17:38:05.308 [main] INFO  c.c.water.WaterDispenserApplication - Starting WaterDispenserApplication using Java 21.0.4 on DESKTOP-BFCFFNA with PID 49080 (D:\java-project-mod\springboot-mqtt-campuswater\target\classes started by 12187 in D:\java-project-mod\springboot-mqtt-campuswater)
2025-05-26 17:38:05.311 [main] INFO  c.c.water.WaterDispenserApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-26 17:38:06.844 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-05-26 17:38:06.857 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-26 17:38:06.858 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-26 17:38:06.859 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.78]
2025-05-26 17:38:06.973 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-26 17:38:06.973 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1620 ms
2025-05-26 17:38:07.139 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-26 17:38:07.401 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-26 17:38:07.594 [main] INFO  com.campus.water.service.MqttService - 正在初始化MQTT客户端...
2025-05-26 17:38:07.952 [main] INFO  com.campus.water.service.MqttService - MQTT客户端连接成功
2025-05-26 17:38:07.961 [main] INFO  com.campus.water.service.MqttService - 已订阅所有主题
2025-05-26 17:38:08.380 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-26 17:38:08.398 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-05-26 17:38:08.413 [main] INFO  c.c.water.WaterDispenserApplication - Started WaterDispenserApplication in 3.734 seconds (JVM running for 4.767)
2025-05-26 17:38:19.372 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubIDdata] 的消息: {"id":12345}
2025-05-26 17:38:19.467 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理饮水机 [12345] 的饮水记录查询请求...
2025-05-26 17:38:19.544 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subRIDdata]: [{"id":12345,"time":"13:00:00","drink":100},{"id":12345,"time":"23:00:00","drink":100}]
2025-05-26 17:38:19.548 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 17:38:19.548 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 饮水机 [12345] 的饮水记录查询结果: 2条记录
2025-05-26 17:38:28.350 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"李想"}
2025-05-26 17:38:28.351 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [李想] 的饮水记录查询请求...
2025-05-26 17:38:28.356 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: [{"id":12345,"time":"13:00:00","drink":100}]
2025-05-26 17:38:28.361 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 17:38:28.361 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 学生 [李想] 的饮水记录查询结果: 1条记录
2025-05-26 17:38:35.094 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 收到主题 [pubNameData] 的消息: {"name":"张三"}
2025-05-26 17:38:35.096 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在处理学生 [张三] 的饮水记录查询请求...
2025-05-26 17:38:35.099 [MQTT Call: campus-water-server] WARN  com.campus.water.service.MqttService - 未找到学生 [张三] 的饮水记录
2025-05-26 17:38:35.099 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 正在发布消息到主题 [subCard]: {"error":"该饮水卡记录不存在"}
2025-05-26 17:38:35.106 [MQTT Call: campus-water-server] INFO  com.campus.water.service.MqttService - 消息发布成功
2025-05-26 17:43:53.905 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-26 17:43:53.950 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
